

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Scraping craigslist - Predictably Noisy</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Predictably Noisy">
<meta property="og:title" content="Scraping craigslist">


  <link rel="canonical" href="https://predictablynoisy.com/craigslist-scrape">
  <meta property="og:url" content="https://predictablynoisy.com/craigslist-scrape">



  <meta property="og:description" content="OverviewIn this notebook, I’ll show you how to make a simple query on Craigslist using some nifty python modules. You can take advantage of all the structure data that exists on webpages to collect interesting datasets.">



  <meta name="twitter:site" content="@choldgraf">
  <meta name="twitter:title" content="Scraping craigslist">
  <meta name="twitter:description" content="OverviewIn this notebook, I’ll show you how to make a simple query on Craigslist using some nifty python modules. You can take advantage of all the structure data that exists on webpages to collect interesting datasets.">
  <meta name="twitter:url" content="https://predictablynoisy.com/craigslist-scrape">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2015-08-30T00:00:00-07:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Chris Holdgraf",
      "url" : "https://predictablynoisy.com",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->

<link href="https://predictablynoisy.com/feed.xml" type="application/atom+xml" rel="alternate" title="Predictably Noisy Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- Custom CSS -->
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/holdgraf.css">

<!-- For all browsers -->
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/main.css">



<meta http-equiv="cleartype" content="on">

    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="https://predictablynoisy.com/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="https://predictablynoisy.com/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="https://predictablynoisy.com/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="https://predictablynoisy.com/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="https://predictablynoisy.com/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="https://predictablynoisy.com/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="https://predictablynoisy.com/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="https://predictablynoisy.com/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="https://predictablynoisy.com/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="https://predictablynoisy.com/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="https://predictablynoisy.com/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="https://predictablynoisy.com/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="https://predictablynoisy.com/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<!-- Load JQuery -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

<!-- Load clipboard.js -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>

<!-- Custom scripts to load after site JS is loaded -->
<script src="https://predictablynoisy.com/assets/js/copypaste.js" type="text/javascript"></script>


<!-- end custom head snippets -->

    <link rel="stylesheet" href="/assets/css/data8.css">
    <link rel="stylesheet" href="/assets/css/holdgraf.css">

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://predictablynoisy.com/">Predictably Noisy</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/about/">About</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/opensource/">Open Source</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/talks/">Talks</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/cv/">CV</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Scraping craigslist">
    <meta itemprop="description" content="OverviewIn this notebook, I’ll show you how to make a simple query on Craigslist using some nifty python modules. You can take advantage of all the structure data that exists on webpages to collect interesting datasets.">
    <meta itemprop="datePublished" content="August 30, 2015">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Scraping craigslist
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  14 minute read
	
</p>
          
        
        
        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2015-08-30T00:00:00-07:00">August 30, 2015</time></p>
        
        
             
        
    
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="overview">Overview</h2>
<p>In this notebook, I’ll show you how to make a simple query on Craigslist using some nifty python modules. You can take advantage of all the structure data that exists on webpages to collect interesting datasets.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span> <span class="k">as</span> <span class="n">bs4</span>
<span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>
</code></pre></div>  </div>

</div>

<p>First we need to figure out how to submit a query to Craigslist. As with many websites, one way you can do this is simply by constructing the proper URL and sending it to Craigslist. Here’s a sample URL that is returned after manually typing in a search to Craigslist:</p>
<blockquote>
  <p><code class="highlighter-rouge">http://sfbay.craigslist.org/search/eby/apa?bedrooms=1&amp;pets_cat=1&amp;pets_dog=1&amp;is_furnished=1</code></p>
</blockquote>

<p>This is actually two separate things. The first tells craigslist what kind of thing we’re searching for:</p>

<blockquote>
  <p><code class="highlighter-rouge">http://sfbay.craigslist.org/search/eby/apa</code> says we’re searching in the sfbay area (<code class="highlighter-rouge">sfbay</code>) for apartments (<code class="highlighter-rouge">apa</code>) in the east bay (<code class="highlighter-rouge">eby</code>).</p>
</blockquote>

<p>The second part contains the parameters that we pass to the search:</p>

<blockquote>
  <p><code class="highlighter-rouge">?bedrooms=1&amp;pets_cat=1&amp;pets_dog=1&amp;is_furnished=1</code> says we want 1+ bedrooms, cats allowed, dogs allowed, and furnished apartments. You can manually change these fields in order to create new queries.</p>
</blockquote>

<h2 id="getting-a-single-posting">Getting a single posting</h2>

<p>So, we’ll use this knowledge to send some custom URLs to Craigslist. We’ll do this using the <code class="highlighter-rouge">requests</code> python module, which is really useful for querying websites.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
</code></pre></div>  </div>

</div>

<p>In internet lingo, we’re posting a <code class="highlighter-rouge">get</code> requests to the website, which simply says that we’d like to get some information from the Craigslist website.  With requests, we can easily create a dictionary that specifies parameters in the URL:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url_base</span> <span class="o">=</span> <span class="s">'http://sfbay.craigslist.org/search/eby/apa'</span>
<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">bedrooms</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">is_furnished</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rsp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url_base</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Note that requests automatically created the right URL:</span>
<span class="k">print</span><span class="p">(</span><span class="n">rsp</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># We can access the content of the response that Craigslist sent back here:</span>
<span class="k">print</span><span class="p">(</span><span class="n">rsp</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="mi">500</span><span class="p">])</span>
</code></pre></div>  </div>

</div>

<p>Wow, that’s a lot of code. Remember, websites serve HTML documents, and usually your browser will automatically render this into a nice webpage for you. Since we’re doing this with python, we get back the raw text. This is really useful, but how can we possibly parse it all?</p>

<p>For this, we’ll turn to another great package, BeautifulSoup:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># BS4 can quickly parse our text, make sure to tell it that you're giving html</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">bs4</span><span class="p">(</span><span class="n">rsp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>

<span class="c"># BS makes it easy to look through a document</span>
<span class="k">print</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">prettify</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">])</span>
</code></pre></div>  </div>

</div>

<p>Beautiful soup lets us quickly search through an HTML document. We can pull out whatever information we want.</p>

<p>Scanning through this text, we see a common structure repeated <code class="highlighter-rouge">&lt;p class="row"&gt;</code>. This seems to be the container that has information for a single apartment.</p>

<p>In BeautifulSoup, we can quickly get all instances of this container:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># find_all will pull entries that fit your search criteria.</span>
<span class="c"># Note that we have to use brackets to define the `attrs` dictionary</span>
<span class="c"># Because "class" is a special word in python, so we need to give a string.</span>
<span class="n">apts</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'row'</span><span class="p">})</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">apts</span><span class="p">))</span>
</code></pre></div>  </div>

</div>

<p>Now let’s look inside the values of a single apartment listing:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># We can see that there's a consistent structure to a listing.</span>
<span class="c"># There is a 'time', a 'name', a 'housing' field with size/n_brs, etc.</span>
<span class="n">this_appt</span> <span class="o">=</span> <span class="n">apts</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">this_appt</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>
</code></pre></div>  </div>

</div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IndexError                                Traceback (most recent call last)
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-8-b82880a42248&gt; in &lt;module&gt;()
      1 # We can see that there's a consistent structure to a listing.
      2 # There is a 'time', a 'name', a 'housing' field with size/n_brs, etc.
----&gt; 3 this_appt = apts[15]
      4 print(this_appt.prettify())

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IndexError: list index out of range
</code></pre></div></div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># So now we'll pull out a couple of things we might be interested in:</span>
<span class="c"># It looks like "housing" contains size information. We'll pull that.</span>
<span class="c"># Note that `findAll` returns a list, since there's only one entry in</span>
<span class="c"># this HTML, we'll just pull the first item.</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">this_appt</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'housing'</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
<span class="k">print</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NameError                                 Traceback (most recent call last)
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-9-4fb8a04b88f7&gt; in &lt;module&gt;()
      3 # Note that `findAll` returns a list, since there's only one entry in
      4 # this HTML, we'll just pull the first item.
----&gt; 5 size = this_appt.findAll(attrs={'class': 'housing'})[0].text
      6 print(size)

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NameError: name 'this_appt' is not defined
</code></pre></div></div>

<p>We can query split this into n_bedrooms and the size. However, note that sometimes one of these features might be missing. So we’ll use an <code class="highlighter-rouge">if</code> statement to try and capture this variability:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">find_size_and_brs</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
    <span class="n">split</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">'/- '</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' - '</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">n_brs</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'br'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="n">this_size</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'ft2'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'br'</span> <span class="ow">in</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c"># It's the n_bedrooms</span>
        <span class="n">n_brs</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'br'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="n">this_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">elif</span> <span class="s">'ft2'</span> <span class="ow">in</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c"># It's the size</span>
        <span class="n">this_size</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'ft2'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="n">n_brs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">this_size</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">n_brs</span><span class="p">)</span>
<span class="n">this_size</span><span class="p">,</span> <span class="n">n_brs</span> <span class="o">=</span> <span class="n">find_size_and_brs</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AttributeError                            Traceback (most recent call last)
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-10-56ab1d345ab4&gt; in &lt;module&gt;()
     13         n_brs = np.nan
     14     return float(this_size), float(n_brs)
---&gt; 15 this_size, n_brs = find_size_and_brs(size)

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-10-56ab1d345ab4&gt; in find_size_and_brs(size)
      1 def find_size_and_brs(size):
----&gt; 2     split = size.strip('/- ').split(' - ')
      3     if len(split) == 2:
      4         n_brs = split[0].replace('br', '')
      5         this_size = split[1].replace('ft2', '')

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AttributeError: 'function' object has no attribute 'strip'
</code></pre></div></div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Now we'll also pull a few other things:</span>
<span class="n">this_time</span> <span class="o">=</span> <span class="n">this_appt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'time'</span><span class="p">)[</span><span class="s">'datetime'</span><span class="p">]</span>
<span class="n">this_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">this_time</span><span class="p">)</span>
<span class="n">this_price</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">this_appt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'span'</span><span class="p">,</span> <span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'price'</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">'$'</span><span class="p">))</span>
<span class="n">this_title</span> <span class="o">=</span> <span class="n">this_appt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'a'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'hdrlnk'</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
</code></pre></div>  </div>

</div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NameError                                 Traceback (most recent call last)
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-11-bc17374a1087&gt; in &lt;module&gt;()
      1 # Now we'll also pull a few other things:
----&gt; 2 this_time = this_appt.find('time')['datetime']
      3 this_time = pd.to_datetime(this_time)
      4 this_price = float(this_appt.find('span', {'class': 'price'}).text.strip('$'))
      5 this_title = this_appt.find('a', attrs={'class': 'hdrlnk'}).text

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NameError: name 'this_appt' is not defined
</code></pre></div></div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Now we've got the n_bedrooms, size, price, and time of listing</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">this_size</span><span class="p">,</span> <span class="n">n_brs</span><span class="p">,</span> <span class="n">this_time</span><span class="p">,</span> <span class="n">this_price</span><span class="p">,</span> <span class="n">this_title</span><span class="p">]]))</span>
</code></pre></div>  </div>

</div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NameError                                 Traceback (most recent call last)
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-12-6b0491d04915&gt; in &lt;module&gt;()
      1 # Now we've got the n_bedrooms, size, price, and time of listing
----&gt; 2 print('\n'.join([str(i) for i in [this_size, n_brs, this_time, this_price, this_title]]))

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NameError: name 'this_size' is not defined
</code></pre></div></div>

<h2 id="querying-lots-of-postings">Querying lots of postings</h2>

<p>Cool - so now we’ve got some useful information about one listing. Now let’s loop through many listings across several locations.</p>

<p>It looks like there is a “city code” that distinguishes where you’re searching. Here is a <strong>not</strong> up to date list: <a href="https://sites.google.com/site/clsiteinfo/city-site-code-sort">link</a></p>

<p>Within the Bay Area, there are also a lot of sub-regional locations, which we’ll define here, then loop through them all.</p>

<p>Note that the <code class="highlighter-rouge">s</code> parameter tells Craiglist where to start in terms of the number of results given back. E.g., if s==100, then it starts at the 100th entry.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">loc_prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s">'eby'</span><span class="p">,</span> <span class="s">'nby'</span><span class="p">,</span> <span class="s">'sfc'</span><span class="p">,</span> <span class="s">'sby'</span><span class="p">,</span> <span class="s">'scz'</span><span class="p">]</span>
</code></pre></div>  </div>

</div>

<p>We’ll define a few helper functions to handle edge cases and make sure that we don’t get any errors.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">find_prices</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="n">prices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rw</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">price</span> <span class="o">=</span> <span class="n">rw</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'span'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'result-price'</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">price</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">price</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">price</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">'$'</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">price</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">prices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prices</span>

<span class="k">def</span> <span class="nf">find_times</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rw</span> <span class="ow">in</span> <span class="n">apts</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="s">'datetime'</span><span class="p">]</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">times</span>
</code></pre></div>  </div>

</div>

<p>Now we’re ready to go. We’ll loop through all of our locations, and pull a number of entries for each one. We’ll use a pandas dataframe to store everything, because this will be useful for future analysis.</p>

<p><strong>Note</strong> - Craigslist won’t take kindly to you querying their server a bunch of times at once. Make sure not to pull too much data too quickly. Another option is to add a delay to each loop iteration. Otherwise your IP might get banned.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>
</code></pre></div>  </div>

</div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NameError                                 Traceback (most recent call last)
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-9-97e76ea257b9&gt; in &lt;module&gt;()
----&gt; 1 print(txt.prettify())

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NameError: name 'txt' is not defined
</code></pre></div></div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">find_size_and_brs</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
    <span class="n">split</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="n">ii</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">' -'</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">split</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">n_brs</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'br'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="n">this_size</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'ft2'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">'br'</span> <span class="ow">in</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c"># It's the n_bedrooms</span>
        <span class="n">n_brs</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'br'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="n">this_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">elif</span> <span class="s">'ft2'</span> <span class="ow">in</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c"># It's the size</span>
        <span class="n">this_size</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'ft2'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
        <span class="n">n_brs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">this_size</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">n_brs</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Now loop through all of this and store the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># We'll store the data here</span>
<span class="c"># Careful with this...too many queries == your IP gets banned temporarily</span>
<span class="n">search_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">loc_prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s">'eby'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">loc_prefixes</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">loc</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">search_indices</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">'http://sfbay.craigslist.org/search/{0}/apa'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">'bedrooms'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'s'</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">bs4</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
        <span class="n">apts</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">"result-info"</span><span class="p">})</span>

        <span class="c"># Find the size of all entries</span>
        <span class="n">size_text</span> <span class="o">=</span> <span class="p">[</span><span class="n">rw</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'housing'</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
                     <span class="k">for</span> <span class="n">rw</span> <span class="ow">in</span> <span class="n">apts</span><span class="p">]</span>
        <span class="n">sizes_brs</span> <span class="o">=</span> <span class="p">[</span><span class="n">find_size_and_brs</span><span class="p">(</span><span class="n">stxt</span><span class="p">)</span> <span class="k">for</span> <span class="n">stxt</span> <span class="ow">in</span> <span class="n">size_text</span><span class="p">]</span>
        <span class="n">sizes</span><span class="p">,</span> <span class="n">n_brs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">sizes_brs</span><span class="p">)</span>  <span class="c"># This unzips into 2 vectors</span>

        <span class="c"># Find the title and link</span>
        <span class="n">title</span> <span class="o">=</span> <span class="p">[</span><span class="n">rw</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'a'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'hdrlnk'</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
                      <span class="k">for</span> <span class="n">rw</span> <span class="ow">in</span> <span class="n">apts</span><span class="p">]</span>
        <span class="n">links</span> <span class="o">=</span> <span class="p">[</span><span class="n">rw</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'a'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'hdrlnk'</span><span class="p">})[</span><span class="s">'href'</span><span class="p">]</span>
                 <span class="k">for</span> <span class="n">rw</span> <span class="ow">in</span> <span class="n">apts</span><span class="p">]</span>

        <span class="c"># Find the time</span>
        <span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">rw</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'time'</span><span class="p">)[</span><span class="s">'datetime'</span><span class="p">])</span> <span class="k">for</span> <span class="n">rw</span> <span class="ow">in</span> <span class="n">apts</span><span class="p">]</span>
        <span class="n">price</span> <span class="o">=</span> <span class="n">find_prices</span><span class="p">(</span><span class="n">apts</span><span class="p">)</span>

        <span class="c"># We'll create a dataframe to store all the data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">time</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">n_brs</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">links</span><span class="p">])</span>
        <span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'time'</span><span class="p">,</span> <span class="s">'price'</span><span class="p">,</span> <span class="s">'size'</span><span class="p">,</span> <span class="s">'brs'</span><span class="p">,</span> <span class="s">'title'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'time'</span><span class="p">)</span>

        <span class="c"># Add the location variable to all entries</span>
        <span class="n">df</span><span class="p">[</span><span class="s">'loc'</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        
<span class="c"># Finally, concatenate all the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">seconds_to_days</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">seconds</span> <span class="o">/</span> <span class="mf">60.</span> <span class="o">/</span> <span class="mf">60.</span> <span class="o">/</span> <span class="mf">24.</span>

<span class="c"># We'll make sure that the right columns are represented numerically:</span>
<span class="n">results</span><span class="p">[[</span><span class="s">'price'</span><span class="p">,</span> <span class="s">'size'</span><span class="p">,</span> <span class="s">'brs'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[[</span><span class="s">'price'</span><span class="p">,</span> <span class="s">'size'</span><span class="p">,</span> <span class="s">'brs'</span><span class="p">]]</span><span class="o">.</span><span class="n">convert_objects</span><span class="p">(</span><span class="n">convert_numeric</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'time'</span>

<span class="c"># Add the age of each result</span>
<span class="n">now</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
<span class="n">results</span><span class="p">[</span><span class="s">'age'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">seconds_to_days</span><span class="p">((</span><span class="n">now</span> <span class="o">-</span> <span class="n">ii</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
                  <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
</code></pre></div>  </div>

</div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># And there you have it:</span>
<span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>  </div>

</div>

<div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>size</th>
      <th>brs</th>
      <th>title</th>
      <th>link</th>
      <th>loc</th>
      <th>age</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-11-17 09:12:00</th>
      <td>2450.0</td>
      <td>850.0</td>
      <td>3.0</td>
      <td>APARTMENT 3 BR/ 1 BT</td>
      <td>/eby/apa/5873549022.html</td>
      <td>eby</td>
      <td>2.952374</td>
    </tr>
    <tr>
      <th>2016-11-17 09:12:00</th>
      <td>2005.0</td>
      <td>790.0</td>
      <td>1.0</td>
      <td>Perfect Cozy One-Bedroom Available Now! Only $...</td>
      <td>/eby/apa/5880750933.html</td>
      <td>eby</td>
      <td>2.952374</td>
    </tr>
    <tr>
      <th>2016-11-17 09:12:00</th>
      <td>1875.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>FANTASTIC PLACE - Lovely Yard!</td>
      <td>/eby/apa/5870868630.html</td>
      <td>eby</td>
      <td>2.952374</td>
    </tr>
    <tr>
      <th>2016-11-17 09:11:00</th>
      <td>1525.0</td>
      <td>650.0</td>
      <td>1.0</td>
      <td>Large 1 bedroom Washer/Dryer</td>
      <td>/eby/apa/5865407315.html</td>
      <td>eby</td>
      <td>2.946333</td>
    </tr>
    <tr>
      <th>2016-11-17 09:11:00</th>
      <td>6000.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>3BR/2.5BA Home Panoramic Views (90 Skyway Lane)</td>
      <td>/eby/apa/5880673685.html</td>
      <td>eby</td>
      <td>2.946333</td>
    </tr>
  </tbody>
</table>
</div>
</div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s">'price'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100</span><span class="p">))[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Mother of god.'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Price'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2015/ntbk/2015-08-30-craigslist_scrape_30_1.png" alt="png" /></p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">target_price</span> <span class="o">=</span> <span class="mf">2200.</span>
<span class="n">target_size</span> <span class="o">=</span> <span class="mf">1400.</span>
<span class="n">highlight</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">target_price</span><span class="p">,</span> <span class="n">target_size</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'eby'</span><span class="p">,</span> <span class="s">'Mine'</span><span class="p">,</span> <span class="s">'None'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s">'age'</span><span class="p">]</span><span class="o">.</span><span class="nb">max</span><span class="p">()]],</span>
                         <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'price'</span><span class="p">,</span> <span class="s">'size'</span><span class="p">,</span> <span class="s">'brs'</span><span class="p">,</span> <span class="s">'loc'</span><span class="p">,</span> <span class="s">'title'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'mine'</span><span class="p">,</span> <span class="s">'age'</span><span class="p">])</span>
<span class="n">results</span><span class="p">[</span><span class="s">'mine'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">highlight</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">altair</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">altair</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'size'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'price'</span><span class="p">,</span>
                                   <span class="n">color</span><span class="o">=</span><span class="s">'mine:N'</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div>
<div class="vega-embed" id="b5c5d25b-82b9-48b4-b4c5-5596b3e90154"></div>

<style>
.vega-embed svg, .vega-embed canvas {
  border: 1px dotted gray;
}

.vega-embed .vega-actions a {
  margin-right: 6px;
}
</style>

</div>

<p><img src="../images/2015/ntbk/2015-08-30-craigslist_scrape_32_2.png" alt="png" /></p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">smin</span><span class="p">,</span> <span class="n">smax</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1300</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
<span class="n">n_br</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c"># subset = results.query('size &gt; @smin and size &lt; @smax')</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">results</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s">'brs &lt; 4'</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'brs'</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s">'price'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">target_price</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">)</span>

</code></pre></div>  </div>

</div>

<p><img src="../images/2015/ntbk/2015-08-30-craigslist_scrape_33_1.png" alt="png" /></p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Finally, we can save this data to a CSV to play around with it later.</span>
<span class="c"># We'll have to remove some annoying characters first:</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="n">use_chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span>\
    <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span> <span class="o">+</span>\
    <span class="s">' /</span><span class="err">\</span><span class="s">.'</span>
<span class="n">results</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">use_chars</span><span class="p">]))</span>

<span class="n">results</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'../data/craigslist_results.csv'</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<h2 id="recap">RECAP</h2>
<p>To sum up what we just did:</p>

<ul>
  <li>We defined the ability to query a website using a custom URL. This is usually the same in structure for website, but the parameter names will be different.</li>
  <li>We sent a <code class="highlighter-rouge">get</code> request to Craigslist using the <code class="highlighter-rouge">requests</code> module of python.</li>
  <li>We parsed the response using <code class="highlighter-rouge">BeautifulSoup4</code>.</li>
  <li>We then looped through a bunch of apartment listings, pulled some relevant data, and combined it all into a cleaned and usable dataframe with <code class="highlighter-rouge">pandas</code>.</li>
</ul>

<p>Next up I’ll take a look at the data, and see if there’s anything interesting to make of it.</p>

<h2 id="bonus---auto-emailing-yourself-w-notifications">Bonus - auto-emailing yourself w/ notifications</h2>
<p>A few people have asked me about using this kind of process to make a bot that scrapes craigslist periodically. This is actually quite simple, as it basically involves pulling the top listings from craigslist, checking this against an “old” list, and detecting if there’s anything new that has popped up since the last time you checked.</p>

<p>Here’s a simple script that will get the job done. Once again, don’t pull too much data at once, and don’t query Craigslist too frequently, or you’re gonna get banned.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># We'll use the gmail module (there really is a module for everything in python)</span>
<span class="kn">import</span> <span class="nn">gmail</span>
<span class="kn">import</span> <span class="nn">time</span>
</code></pre></div>  </div>

</div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gm</span> <span class="o">=</span> <span class="n">gmail</span><span class="o">.</span><span class="n">GMail</span><span class="p">(</span><span class="s">'my_username'</span><span class="p">,</span> <span class="s">'my_password'</span><span class="p">)</span>
<span class="n">gm</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="c"># Define our URL and a query we want to post</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s">'http://sfbay.craigslist.org/'</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s">'search/eby/apa?nh=48&amp;anh=49&amp;nh=112&amp;nh=58&amp;nh=61&amp;nh=62&amp;nh=66&amp;max_price=2200&amp;bedrooms=1'</span>

<span class="c"># This will remove weird characters that people put in titles like ****!***!!!</span>
<span class="n">use_chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span> <span class="o">+</span> <span class="s">' '</span>
</code></pre></div>  </div>

</div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SMTPAuthenticationError                   Traceback (most recent call last)
</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-2-49f6a18c0f58&gt; in &lt;module&gt;()
      1 gm = gmail.GMail('my_username', 'my_password')
----&gt; 2 gm.connect()
      3 
      4 # Define our URL and a query we want to post
      5 base_url = 'http://sfbay.craigslist.org/'

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/choldgraf/anaconda/lib/python2.7/site-packages/gmail/gmail.pyc in connect(self)
     65         self.session.ehlo()
     66         try:
---&gt; 67             self.session.login(self.username,self.password)
     68         except SMTPAuthenticationError,e:
     69             # Catch redirect to account unlock &amp; reformat

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Users/choldgraf/anaconda/lib/python2.7/smtplib.pyc in login(self, user, password)
    620             # 235 == 'Authentication successful'
    621             # 503 == 'Error: already authenticated'
--&gt; 622             raise SMTPAuthenticationError(code, resp)
    623         return (code, resp)
    624 

</code></pre></div></div>

<div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SMTPAuthenticationError: (535, '5.7.8 Username and Password not accepted. Learn more at\n5.7.8  https://support.google.com/mail/answer/14257 of1sm4627014pbc.11 - gsmtp')
</code></pre></div></div>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">link_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># We'll store the data here</span>
<span class="n">link_list_send</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># This is a list of links to be sent</span>
<span class="n">send_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># This is what will actually be sent in the email</span>

<span class="c"># Careful with this...too many queries == your IP gets banned temporarily</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">bs4</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
    <span class="n">apts</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">"row"</span><span class="p">})</span>
    
    <span class="c"># We're just going to pull the title and link</span>
    <span class="k">for</span> <span class="n">apt</span> <span class="ow">in</span> <span class="n">apts</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">apt</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'hdrlnk'</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">title</span><span class="o">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">use_chars</span><span class="p">])</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'href'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">link</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">link_list</span> <span class="ow">and</span> <span class="n">link</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">link_list_send</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'Found new listing'</span><span class="p">)</span>
            <span class="n">link_list_send</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
            <span class="n">send_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">'  -  '</span> <span class="o">+</span> <span class="n">base_url</span><span class="o">+</span><span class="n">link</span><span class="p">)</span>
            
    <span class="c"># Flush the cache if we've found new entries</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">link_list_send</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Sending mail!'</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">send_list</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">Message</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">set_payload</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">gm</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">[</span><span class="s">'recipient_email@mydomain.com'</span><span class="p">])</span>
        <span class="n">link_list</span> <span class="o">+=</span> <span class="n">link_list_send</span>
        <span class="n">link_list_send</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">send_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c"># Sleep a bit so CL doesn't ban us</span>
    <span class="n">sleep_amt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_amt</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<p>And there you have it - your own little bot to keep you on the top of the rental market.</p>

        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://predictablynoisy.com/tags/#" class="page__taxonomy-item" rel="tag"></a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/tags/#python" class="page__taxonomy-item" rel="tag">python</a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/tags/#programming" class="page__taxonomy-item" rel="tag">programming</a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/tags/#" class="page__taxonomy-item" rel="tag"></a>
    
    </span>
  </p>




  






  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://predictablynoisy.com/categories/#" class="page__taxonomy-item" rel="tag"></a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/categories/#" class="page__taxonomy-item" rel="tag"></a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/categories/#" class="page__taxonomy-item" rel="tag"></a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/categories/#computation" class="page__taxonomy-item" rel="tag">computation</a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/categories/#" class="page__taxonomy-item" rel="tag"></a>
    
    </span>
  </p>


      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=https://predictablynoisy.com/craigslist-scrape" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://predictablynoisy.com/craigslist-scrape" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://predictablynoisy.com/craigslist-scrape" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://predictablynoisy.com/craigslist-scrape" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="https://predictablynoisy.com/coherence-correlation-comparison" class="pagination--pager" title="Coherence correlation
">Previous</a>
    
    
      <a href="https://predictablynoisy.com/craigslist-data-analysis" class="pagination--pager" title="Craigslist data analysis
">Next</a>
    
  </nav>

    </div>

    
      

<div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>


    </script>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/choldgraf"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/choldgraf"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://predictablynoisy.com/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Chris Holdgraf. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="https://predictablynoisy.com/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'chrisholdgraf';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>

