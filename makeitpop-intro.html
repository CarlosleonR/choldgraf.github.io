

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Introducing makeitpop, a tool to perceptually warp your data! - Predictably Noisy</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Predictably Noisy">
<meta property="og:title" content="Introducing makeitpop, a tool to perceptually warp your data!">


  <link rel="canonical" href="https://predictablynoisy.com/makeitpop-intro">
  <meta property="og:url" content="https://predictablynoisy.com/makeitpop-intro">



  <meta property="og:description" content="  Note: It should go without saying, but you should never do the stuff that you’re about to read about here. Data is meant to speak for itself, and our visualizations should accurately reflect the data above all else.">



  <meta name="twitter:site" content="@choldgraf">
  <meta name="twitter:title" content="Introducing makeitpop, a tool to perceptually warp your data!">
  <meta name="twitter:description" content="  Note: It should go without saying, but you should never do the stuff that you’re about to read about here. Data is meant to speak for itself, and our visualizations should accurately reflect the data above all else.">
  <meta name="twitter:url" content="https://predictablynoisy.com/makeitpop-intro">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2018-06-04T00:00:00-07:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Chris Holdgraf",
      "url" : "https://predictablynoisy.com",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->

<link href="https://predictablynoisy.com/feed.xml" type="application/atom+xml" rel="alternate" title="Predictably Noisy Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- Custom CSS -->
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/holdgraf.css">

<!-- For all browsers -->
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/main.css">



<meta http-equiv="cleartype" content="on">

    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="https://predictablynoisy.com/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="https://predictablynoisy.com/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="https://predictablynoisy.com/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="https://predictablynoisy.com/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="https://predictablynoisy.com/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="https://predictablynoisy.com/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="https://predictablynoisy.com/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="https://predictablynoisy.com/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="https://predictablynoisy.com/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="https://predictablynoisy.com/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="https://predictablynoisy.com/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="https://predictablynoisy.com/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="https://predictablynoisy.com/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<!-- Load JQuery -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

<!-- Load clipboard.js -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>

<!-- Custom scripts to load after site JS is loaded -->
<script src="https://predictablynoisy.com/assets/js/copypaste.js" type="text/javascript"></script>


<!-- end custom head snippets -->

    <link rel="stylesheet" href="/assets/css/data8.css">
    <link rel="stylesheet" href="/assets/css/holdgraf.css">

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://predictablynoisy.com/">Predictably Noisy</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/about/">About</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/opensource/">Open Source</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/talks/">Talks</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/cv/">CV</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Introducing makeitpop, a tool to perceptually warp your data!">
    <meta itemprop="description" content="  Note: It should go without saying, but you should never do the stuff that you’re about to read about here. Data is meant to speak for itself, and our visualizations should accurately reflect the data above all else.">
    <meta itemprop="datePublished" content="June 04, 2018">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Introducing <em>makeitpop</em>, a tool to perceptually warp your data!
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  15 minute read
	
</p>
          
        
        
        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2018-06-04T00:00:00-07:00">June 04, 2018</time></p>
        
        
             
        
    
        </header>
      

      <section class="page__content" itemprop="text">
        <a href="https://mybinder.org/v2/gh/choldgraf/choldgraf.github.io/master?urlpath=lab/tree//notebooks/2018/2018-06-04-makeitpop.ipynb"><img src="https://mybinder.org/badge.svg" /></a>
        <blockquote>
  <p><em>Note: It should go without saying, but <strong>you should never do the stuff that you’re about to read about here</strong>. Data is meant to speak for itself, and our visualizations should accurately reflect the data above all else.</em></p>
</blockquote>

<p>When I was in graduate school, I tended to get on my soapbox and tell everybody
why they should <a href="http://jakevdp.github.io/blog/2014/10/16/how-bad-is-your-colormap/">stop using Jet</a>
and adopt a “perceptually-flat” colormap like <a href="https://bids.github.io/colormap/">viridis, magma, or inferno</a>.</p>

<p>Surprisingly (ok, maybe not so surprisingly) I got a lot of pushback from people. Folks would say <em>“But I like <strong>jet</strong>, it really highlights my data, it makes the images ‘pop’ more effectively than viridis!”</em>.</p>

<p>Unfortunately it turns out that when a colormap “makes your data pop”, it really just means “<a href="https://bids.github.io/colormap/">warps your perception of the visualized data so that you see non-linearities when there are none</a>”. AKA, a colormap like Jet actually <em>mis-represents</em> the data.</p>

<p>But what does this really mean? It’s difficult to talk and think about coor - especially when it comes to relating color with objective relationships
between data. Rather than talking about colormaps in the abstract, what if we could <em>visualize</em> the warping that is performed by colormaps like Jet?</p>

<p>In this post I’ll show that this is possible! Introducing <strong><code class="highlighter-rouge">makeitpop</code></strong>.</p>

<h2 id="what-does-makeitpop-do">What does <em>makeitpop</em> do?</h2>

<p>Makeitpop lets you apply the same perceptual warping that would <em>normally</em> be accomplished
with a colormap like Jet, but applies this warping to <em>the data itself</em>! This lets us
get the same effect with a nice linear colormap like <code class="highlighter-rouge">viridis</code>!</p>

<p>For example, let’s take a look at the <a href="https://matplotlib.org/gallery/images_contours_and_fields/image_demo.html#sphx-glr-gallery-images-contours-and-fields-image-demo-py">image demo in matplotlib</a>. In it, we create two blobs that are meant to be visualized as an image. We’ll visualize this with our old friend viridis.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a mesh grid with two gaussian blobs</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mf">0.025</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z1</span> <span class="o">-</span> <span class="n">Z2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

<span class="c"># Visualize it</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span>
          <span class="n">origin</span><span class="o">=</span><span class="s">'lower'</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
          <span class="n">vmax</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=-</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Original data</span><span class="se">\n</span><span class="s">linear colormap"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_2_0.png" alt="png" /></p>

<p>Hmmm, not too bad…but it’s a bit <em>boring</em>, no? Why can’t we make it snazzier? I know, let’s use Jet!</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Visualize our data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span>
          <span class="n">origin</span><span class="o">=</span><span class="s">'lower'</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
          <span class="n">vmax</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=-</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Original data</span><span class="se">\n</span><span class="s">non-linear colormap"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_4_0.png" alt="png" /></p>

<p>Oooh now that’s what I’m talking about. You can clearly see two peaks of significant results
at the center of each circle. Truly this is fit for publishing in <em>Nature</em>.</p>

<p>But…as you all know, this data only <em>looks</em> better because we’ve used a colormap that distorts
our perception of the underlying data.</p>

<p>Let’s illustrate this by <strong>making it pop</strong>!</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Pop the data!</span>
<span class="n">Z_popped</span> <span class="o">=</span> <span class="n">makeitpop</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="s">'jet'</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c"># Visualize the warped data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z_popped</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span>
          <span class="n">origin</span><span class="o">=</span><span class="s">'lower'</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
          <span class="n">vmax</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=-</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Warped data</span><span class="se">\n</span><span class="s">linear colormap"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_6_0.png" alt="png" /></p>

<p>Excellent! We’re using a nice, perceptually-flat colormap like viridis, but we’ve attained
an effect similar to the one that <em>Jet</em> would have created!</p>

<p>Now let’s visualize all three next to each other so that we can see the total effect:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">kws_img</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s">'lower'</span><span class="p">,</span>
               <span class="n">vmax</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=-</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">())</span>

<span class="c"># Raw data with a perceptually-flat colormap</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span> <span class="o">**</span><span class="n">kws_img</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Original data</span><span class="se">\n</span><span class="s">linear colormap"</span><span class="p">)</span>

<span class="c"># Raw data with a perceptually-distorted colormap</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="o">**</span><span class="n">kws_img</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Original data</span><span class="se">\n</span><span class="s">non-linear colormap"</span><span class="p">)</span>

<span class="c"># Distorted data with a perceptually-flat colormap</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z_popped</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span> <span class="o">**</span><span class="n">kws_img</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Warped data</span><span class="se">\n</span><span class="s">linear colormap"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_8_0.png" alt="png" /></p>

<h2 id="lets-see-it-in-the-real-world">Let’s see it in the real world</h2>

<p>Thus far I’ve been using toy examples to illustrate how makeitpop works. Let’s see how
things look on an actual dataset collected in the wild.</p>

<p>For this, we’ll use the excellent <a href="https://nilearn.github.io/">nilearn</a> package. This has a
few datasets we can download to demonstrate our point. First we’ll load the data and prep it:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="n">nb</span>

<span class="c"># Load a sample dataset</span>
<span class="n">tmap_filenames</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_localizer_button_task</span><span class="p">()[</span><span class="s">'tmaps'</span><span class="p">]</span>
<span class="n">tmap_filename</span> <span class="o">=</span> <span class="n">tmap_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c"># Threshold our data for viz</span>
<span class="n">brain</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">tmap_filename</span><span class="p">)</span>
<span class="n">brain_data</span> <span class="o">=</span> <span class="n">brain</span><span class="o">.</span><span class="n">get_fdata</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">brain_data</span> <span class="o">&lt;</span> <span class="o">-.</span><span class="mo">01</span><span class="p">,</span> <span class="n">brain_data</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mo">01</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<p>Next, we’ll create a “popped” version of the data, where we apply the non-linear warping
properties of <em>Jet</em> to our data, so that we can visualize the same effect in linear space.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a copy of the data, then pop it</span>
<span class="c"># We'll use a scaling factor to highlight the effect</span>
<span class="n">brain_popped</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">brain_popped</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">makeitpop</span><span class="p">(</span><span class="n">brain_popped</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">colormap</span><span class="o">=</span><span class="s">'jet'</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="mi">75</span><span class="p">)</span>
<span class="n">brain_popped</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">Nifti1Image</span><span class="p">(</span><span class="n">brain_popped</span><span class="p">,</span> <span class="n">brain</span><span class="o">.</span><span class="n">affine</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<p>Now, I’ll plot the results for each.</p>

<ul>
  <li>First, we’ll see the raw data on a linear colormap. This is the way we’d display the data to show the true underlying relationships between datapoints.</li>
  <li>Next, we’ll show the same data plotted with <em>Jet</em>. See how many more significant voxels there are! (/s)</li>
  <li>Finally, we’ll plot the “popped” data using a linear colormap (viridis). This accurately represents the underlying data, but the data <em>itself</em> has been distorted!</li>
</ul>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i_brain</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">brain</span><span class="p">,</span> <span class="s">'original'</span><span class="p">),</span> <span class="p">(</span><span class="n">brain</span><span class="p">,</span> <span class="s">'original (jet)'</span><span class="p">),</span> <span class="p">(</span><span class="n">brain_popped</span><span class="p">,</span> <span class="s">'popped brain'</span><span class="p">)]:</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="s">'jet'</span> <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">'original (jet)'</span> <span class="k">else</span> <span class="s">'viridis'</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">i_brain</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span>
                           <span class="n">title</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_14_0.png" alt="png" /></p>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_14_1.png" alt="png" /></p>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_14_2.png" alt="png" /></p>

<p>As you can see, different kinds of results show up when your perception of the data is affected by the colormap.</p>

<h2 id="how-does-this-work">How does this work?</h2>

<p>OK, so what is the black voodoo magic that makes it possible to “make your data pop”?</p>

<p>It all comes down to your visual system. I won’t go into a ton of detail
because Nathaniel Smith and Stefan van der Walt <a href="https://www.youtube.com/watch?v=xAoljeRJ3lU">already gave a great talk about this</a>, however here is a lay-person’s take:</p>

<p>When we use color to represent data, we are mapping a range of data values onto
a range of color values. Usually this means defining a min / max for our data, then mapping data
values linearly from 0 to 1, and finally mapping those values onto RGB values in a colormap.</p>

<p>Implicit in this process is the idea that stepping across our space in the <em>data</em> equates to
an equal step in our <em>perception</em> of the color that is then chosen. We want a one-to-one mapping between the two.</p>

<p>Unfortunately, this isn’t how our visual system works.</p>

<p>In reality, our brains do all kinds of strange things when interpreting color. They are biased to detect changes between particular kinds of colors, and biased to miss the transition between others.</p>

<p><em>Jet</em> uses a range of colors that highlight this fact. It transitions through colors such that <em>linear</em> changes in our data are perceived as <em>nonlinear</em> changes when we look at the visualization. That’s what makes the data “pop”.</p>

<h2 id="perceptual-delta-curves">Perceptual “delta” curves</h2>

<p>You can determine the extent to which a colormap “warps” your perception of the data by calculating the “perceptual deltas” as you move across the values of a colormap (e.g. as you move from 0 to 1, and their corresponding colors).</p>

<p>These deltas essentially mean “how much is the <em>next</em> color in the colormap perceived as different from the <em>current</em> color?” If your colormap is perceptually flat, the delta will be the <em>same</em> no matter where you are on the range from 0 to 1.</p>

<p>Let’s see what the deltas look like for <em>Jet</em>:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_colormap_deltas</span><span class="p">(</span><span class="n">deltas</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="nb">xrange</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">derivatives</span><span class="p">))</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">xrange</span><span class="p">,</span> <span class="n">deltas</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="nb">xrange</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="nb">xrange</span><span class="o">.</span><span class="nb">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">xrange</span><span class="o">.</span><span class="nb">max</span><span class="p">(),</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">xrange</span><span class="p">,</span> <span class="n">deltas</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_colormap_deltas</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s">'jet'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s">'jet'</span><span class="p">)</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>  <span class="c"># So we can compare with other colormaps</span>
<span class="n">ax</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Perceptual deltas with Jet"</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Text(0.5,1,'Perceptual deltas with Jet')]
</code></pre></div></div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_17_1.png" alt="png" /></p>

<p>Oops.</p>

<p>As you can see, Jet does <strong>not</strong> have a flat line for perceptual deltas. Each “jump” you see above is a moment where Jet is actually <em>mis-representing</em> differences in the data. For shame, Jet.</p>

<p>Now let’s see what this looks like for viridis:</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_colormap_deltas</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="s">'viridis'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s">'viridis'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">"Perceptual deltas with viridis"</span><span class="p">);</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_19_0.png" alt="png" /></p>

<p>Ahhh, sweet, sweet linear representation of data.</p>

<p>In case you’re curious, here are the “perceptual deltas” for several colormaps.
In this case, I’ve centered them and scaled each by the variance of the largest colormap,
so that they are easier to compare.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">deltas</span> <span class="ow">in</span> <span class="n">derivatives_scaled</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s">'linear'</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_colormap_deltas</span><span class="p">(</span><span class="n">deltas</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Scaled perceptual deltas for a bunch of colormaps"</span><span class="p">);</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_21_0.png" alt="png" /></p>

<h2 id="we-can-even-warp-1-dimensional-data">We can even warp 1-dimensional data!</h2>

<p>Let’s see how this principle affects our perception with a different kind of visual
encoding. Now that we know these perceptual warping functions, we can get all the
data-warping properties of jet, but in one dimension!</p>

<p>Here’s a line.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">'k-'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'True Data'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Totally boring line.</span><span class="se">\n</span><span class="s">Nothing to see here.'</span><span class="p">);</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_23_0.png" alt="png" /></p>

<p>Ew. Boring.</p>

<p>Now, let’s make it pop! We’ll loop through a few colormaps, applying its color
warping function to the y-axis of our line as we step through it.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'jet'</span><span class="p">,</span> <span class="s">'viridis'</span><span class="p">,</span> <span class="s">'rainbow'</span><span class="p">,</span> <span class="s">'spring'</span><span class="p">,</span> <span class="s">'hsv'</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">'k-'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'True Data'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">makeitpop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="n">nm</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">nm</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Making data "pop" is fun!'</span><span class="p">)</span>
</code></pre></div>  </div>

</div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5,1,'Making data "pop" is fun!')
</code></pre></div></div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_25_1.png" alt="png" /></p>

<p>As you can see, data looks much more interesting when it’s been non-linearly warped!
It looks particularly striking when you see it on a 1-D plot. This is effectively
what colormaps such as Jet are doing in 2 dimensions! We’re simply bringing the fun
back to 1-D space.</p>

<p>Let’s see how it looks on some scatterplots. We’ll plot the raw data in the background in grey,
and the “popped” data in front in color. Notice how some colormaps distort the y-values more
than others.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'viridis'</span><span class="p">,</span> <span class="s">'jet'</span><span class="p">,</span> <span class="s">'rainbow'</span><span class="p">,</span> <span class="s">'spring'</span><span class="p">,</span> <span class="s">'hsv'</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="o">.</span><span class="mi">2</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>    
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">makeitpop</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_27_0.png" alt="png" /></p>

<h2 id="so-what-should-we-do">So what should we do?</h2>

<p>The reason that I wrote this blog post (and made this silly package) is to illustrate what we’re really
doing when we use a colormap like <em>Jet</em>, and to highlight the importance of using a perceptually-flat colormap.  Sure, we want to choose the visualization that best-makes our point,
but a colormap like Jet is <em>actively mis-representing your data</em>. You’d <em>never</em> consider changing the raw
data values so that an effect popped out, and you’d <em>never</em> alter the y-values of a scatterplot so that something shows up. Well, this is perceptually what you’re doing when you visualize 2-D data with Jet.</p>

<p>Here are a few things to keep in mind moving forward:</p>

<ul>
  <li>Don’t use Jet</li>
  <li>If you review a paper or are an editor for a journal, consider asking authors to use a perceptually flat colormap (this is usually just a matter of changing <code class="highlighter-rouge">cmap='viridis'</code>!)</li>
  <li>Be aware of the effects that color has on the point you’re trying to make. Perceptual warping is
just one of many potential issues with choosing the right color.</li>
</ul>

<h2 id="wrapping-up">Wrapping up</h2>

<p>I hope that this post has been a fun and slightly informative take on the nuances of colormaps, and the unintended effects that they might have.</p>

<p>So, <code class="highlighter-rouge">tl;dr</code>:</p>

<ul>
  <li>Jet (and many other colormaps) mis-represent your perception of the data</li>
  <li>Perceptually flat colormaps like Viridis, Magma, Inferno, or Parula minimize this effect</li>
  <li>You can calculate the <em>extent</em> to which this mis-representation happens as you move along the colormap</li>
  <li>We can then use this function to <em>distort</em> data so that the data itself contains this mis-representation</li>
  <li>But doing so would be super unethical, so in the end <strong>you should stop using jet and use a perceptually-flat colormap like viridis.</strong></li>
</ul>

<p>If you’d like to check out the <code class="highlighter-rouge">makeitpop</code> package, see the <a href="https://github.com/choldgraf/makeitpop">GitHub repo here</a>. In addition, all of the examples in this post are runnable
on Binder! You can launch an interactive session with this code by clicking on the Binder button
at the top of this page!</p>

<h2 id="addendum-ok-but-how-does-makeitpop-actually-work">Addendum: Ok but how does <code class="highlighter-rouge">makeitpop</code> <em>actually</em> work?</h2>

<p>In this section I’ll describe the (admittedly hacky) way that I’ve written <code class="highlighter-rouge">makeitpop</code>.
As I mentioned before, <a href="https://github.com/choldgraf/makeitpop">all the <code class="highlighter-rouge">makeitpop</code> code is on GitHub</a> and
Pull Requests are more than welcome to improve the process (I’m looking at you, “histogram matching” people!)</p>

<p>Here’s what <code class="highlighter-rouge">makeitpop</code> does:</p>

<ol>
  <li>Collects a list of the “perceptual deltas”. These are calculated from the equations given in <a href="https://github.com/matplotlib/viscm"><code class="highlighter-rouge">viscm</code></a>, which was released as a part of the original work that created <code class="highlighter-rouge">viridis</code>.</li>
  <li>Centers each colormap’s deltas at 0.</li>
  <li>Scales each colormap’s deltas by the <em>largest variance</em> across all colormaps. This is to make sure that warping the data is done with the relative differences of each colormap in mind.</li>
  <li>When <code class="highlighter-rouge">makeitpop</code> is called, the function then:
    <ol>
      <li>Scales the input data linearly between 0 and 1</li>
      <li>Calculates the point-by-point derivative for linearly spaced points between 0 and 1 (the derivative is the same for all points here).</li>
      <li>Multiplies each derivative by the scaled perceptual deltas function, plus an extra scaling factor that accentuates the effect.</li>
      <li>Adds each value to the scaled input data.</li>
      <li>Un-scales the altered input data so that it has the same min/max as before.</li>
    </ol>
  </li>
</ol>

<p>There are plenty of ways you could do this more effectively (for example, by matching empirical CDFs and
using linear interpolation to map the delta function of one colormap onto the delta function for another
colormap). If you’d like to contribute or suggest something, feel free to do so! However, I’m just creating
this package to highlight an idea, and think this approach gets close enough with relatively little complexity.</p>

<h1 id="some-extras">Some extras</h1>

<p>Here’s a viz that will let you visualize how different colormaps distort data. We’ll show a
gradient of linearly-spaced values, both using a warping colormap such as “jet” and a linear
colormap like “vidiris”. Then, we’ll “pop” the data and re-visualize with viridis.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a gradient of datapoints</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c"># Pop the data</span>
<span class="n">cmap_warping</span> <span class="o">=</span> <span class="s">'jet'</span>
<span class="n">scaling_factor</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">data_popped</span> <span class="o">=</span> <span class="n">makeitpop</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap_warping</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="p">)</span>

<span class="c"># Visualize</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">derivatives_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> <span class="n">data</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_warping</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Raw data with colormap {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmap_warping</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derivatives_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">derivatives_scaled</span><span class="p">[</span><span class="n">cmap_warping</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s">"First row of image"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">derivatives_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> <span class="n">data</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'viridis'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Raw data with colormap {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">'viridis'</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derivatives_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">derivatives_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> <span class="n">data_popped</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'viridis'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Data warped with colormap {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmap_warping</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derivatives_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">data_popped</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div>  </div>

</div>

<p><img src="../images/2018/ntbk/2018-06-04-makeitpop_32_0.png" alt="png" /></p>

<p>And here’s a little interactive widget to visualize how the scaling factor affects the “pop” effect.</p>

<div class="input_area">

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">IntSlider</span><span class="p">,</span> <span class="n">Dropdown</span>

<span class="k">def</span> <span class="nf">viz</span><span class="p">(</span><span class="n">scaling_factor</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">Z_popped</span> <span class="o">=</span> <span class="n">makeitpop</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="n">scaling_factor</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">),</span>
          <span class="n">origin</span><span class="o">=</span><span class="s">'lower'</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
          <span class="n">vmax</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=-</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">())</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Original data</span><span class="se">\n</span><span class="s">colormap: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmap</span><span class="p">))</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z_popped</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span>
              <span class="n">origin</span><span class="o">=</span><span class="s">'lower'</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="n">vmax</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">(),</span> <span class="n">vmin</span><span class="o">=-</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="nb">max</span><span class="p">())</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Warped like: {}</span><span class="se">\n</span><span class="s">colormap: viridis"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmap</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">interact</span><span class="p">(</span><span class="n">viz</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
         <span class="n">cmap</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">derivatives_scaled</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">'jet'</span><span class="p">))</span>
</code></pre></div>  </div>

</div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>interactive(children=(IntSlider(value=1, description='scaling_factor', max=80, min=1), Dropdown(description='c…
</code></pre></div></div>

<div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;function __main__.viz(scaling_factor, cmap)&gt;
</code></pre></div></div>


        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://predictablynoisy.com/tags/#colormaps" class="page__taxonomy-item" rel="tag">colormaps</a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/tags/#python" class="page__taxonomy-item" rel="tag">python</a>
    
    </span>
  </p>




  






  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://predictablynoisy.com/categories/#colormaps" class="page__taxonomy-item" rel="tag">colormaps</a>
    
    </span>
  </p>


      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=https://predictablynoisy.com/makeitpop-intro" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://predictablynoisy.com/makeitpop-intro" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://predictablynoisy.com/makeitpop-intro" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://predictablynoisy.com/makeitpop-intro" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="https://predictablynoisy.com/jekyll-markdown-nbconvert" class="pagination--pager" title="Blogging with Jupyter Notebooks and Jekyll using nbconvert templates
">Previous</a>
    
    
      <a href="https://predictablynoisy.com/sphinx-copy-buttons" class="pagination--pager" title="Adding copy buttons to code blocks in Sphinx
">Next</a>
    
  </nav>

    </div>

    
      

<div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>


    </script>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/choldgraf"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/choldgraf"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://predictablynoisy.com/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Chris Holdgraf. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="https://predictablynoisy.com/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'chrisholdgraf';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>

