

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Using CircleCI to preview documentation in Pull Requests - Predictably Noisy</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Predictably Noisy">
<meta property="og:title" content="Using CircleCI to preview documentation in Pull Requests">


  <link rel="canonical" href="https://predictablynoisy.com/circle-documentation-build">
  <meta property="og:url" content="https://predictablynoisy.com/circle-documentation-build">



  <meta property="og:description" content="Writing documentation is important - it’s the first point of contact between many users and yourproject, and can be a pivotal moment in whether they decide to adopt your tech or become a contributor.">



  <meta name="twitter:site" content="@choldgraf">
  <meta name="twitter:title" content="Using CircleCI to preview documentation in Pull Requests">
  <meta name="twitter:description" content="Writing documentation is important - it’s the first point of contact between many users and yourproject, and can be a pivotal moment in whether they decide to adopt your tech or become a contributor.">
  <meta name="twitter:url" content="https://predictablynoisy.com/circle-documentation-build">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2018-10-16T00:00:00-07:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Chris Holdgraf",
      "url" : "https://predictablynoisy.com",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->

<link href="https://predictablynoisy.com/feed.xml" type="application/atom+xml" rel="alternate" title="Predictably Noisy Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- Custom CSS -->
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/holdgraf.css">

<!-- For all browsers -->
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/main.css">



<meta http-equiv="cleartype" content="on">

    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="https://predictablynoisy.com/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="https://predictablynoisy.com/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="https://predictablynoisy.com/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="https://predictablynoisy.com/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="https://predictablynoisy.com/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="https://predictablynoisy.com/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="https://predictablynoisy.com/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="https://predictablynoisy.com/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="https://predictablynoisy.com/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="https://predictablynoisy.com/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="https://predictablynoisy.com/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="https://predictablynoisy.com/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="https://predictablynoisy.com/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="https://predictablynoisy.com/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="https://predictablynoisy.com/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<!-- Load JQuery -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

<!-- Load clipboard.js -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>

<!-- Custom scripts to load after site JS is loaded -->
<script src="https://predictablynoisy.com/assets/js/copypaste.js" type="text/javascript"></script>


<!-- end custom head snippets -->

    <link rel="stylesheet" href="/assets/css/data8.css">
    <link rel="stylesheet" href="/assets/css/holdgraf.css">

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://predictablynoisy.com/">Predictably Noisy</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/about/">About</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/opensource/">Open Source</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/talks/">Talks</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://predictablynoisy.com/cv/">CV</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Using CircleCI to preview documentation in Pull Requests">
    <meta itemprop="description" content="Writing documentation is important - it’s the first point of contact between many users and yourproject, and can be a pivotal moment in whether they decide to adopt your tech or become a contributor.">
    <meta itemprop="datePublished" content="October 16, 2018">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Using CircleCI to preview documentation in Pull Requests
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  4 minute read
	
</p>
          
        
        
        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2018-10-16T00:00:00-07:00">October 16, 2018</time></p>
        
        
             
        
    
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>Writing documentation is important - it’s the first point of contact between many users and your
project, and can be a pivotal moment in whether they decide to adopt your tech or become a contributor.</p>

<p>However, it can be a pain to iterate on documentation, as it is often involves a lot of rapid iteration
locally, followed by a push to GitHub where you “just trust” that the author has done a good job of
writing content, design, etc.</p>

<p>A really helpful tip here is to use Continuous Integration to build and preview your documentation. This
allows you to generate a link to the build docs, which is a much better way of reviewing than looking at
the raw text.</p>

<p><img src="/images/2018/sphinx-circle-logos.png" alt="" /></p>

<p>Here’s a simple CircleCI configuration that you can use to build documentation with Sphinx and store it
as an artifact in the build that you can then preview. To set this up, follow these steps:</p>

<h2 id="configure-circleci">Configure CircleCI</h2>

<p>First off, you need to configure CircleCI to build your page. This involves creating a file called <code class="highlighter-rouge">.circle/config.yml</code>
that Circle will use to decide what to do each time your page is built. You then need to go to the CircleCI
website and tell it to build your site.</p>

<p>Here’s a skeleton configuration that will build the documentation with Sphinx:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s">2</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="c1"># Define a "build_docs" job to be run with Circle</span>
  <span class="na">build_docs</span><span class="pi">:</span>
    <span class="c1"># This is the base environment that Circle will use</span>
    <span class="na">docker</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">image</span><span class="pi">:</span> <span class="s">circleci/python:3.6-stretch</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="c1"># Get our data and merge with upstream</span>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">sudo apt-get update</span>
      <span class="pi">-</span> <span class="s">checkout</span>
      <span class="c1"># Update our path</span>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">echo "export PATH=~/.local/bin:$PATH" &gt;&gt; $BASH_ENV</span>
      <span class="c1"># Restore cached files to speed things up</span>
      <span class="pi">-</span> <span class="na">restore_cache</span><span class="pi">:</span>
          <span class="na">keys</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s">cache-pip</span>
      <span class="c1"># Install the packages needed to build our documentation</span>
      <span class="c1"># This will depend on your particular package!</span>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">pip install --user sphinx_rtd_theme sphinx pytest memory_profiler recommonmark sphinx_copybutton jupyterhub</span>
      <span class="c1"># Cache some files for a speedup in subsequent builds</span>
      <span class="pi">-</span> <span class="na">save_cache</span><span class="pi">:</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">cache-pip</span>
          <span class="na">paths</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s">~/.cache/pip</span>
      <span class="c1"># Build the docs</span>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">Build docs to store</span>
          <span class="na">command</span><span class="pi">:</span> <span class="pi">|</span>
            <span class="no">cd doc</span>
            <span class="no">make html</span>
      <span class="c1"># Tell Circle to store the documentation output in a folder that we can access later</span>
      <span class="pi">-</span> <span class="na">store_artifacts</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">doc/_build/html/</span>
          <span class="na">destination</span><span class="pi">:</span> <span class="s">html</span>

<span class="c1"># Tell CircleCI to use this workflow when it builds the site</span>
<span class="na">workflows</span><span class="pi">:</span>
  <span class="na">version</span><span class="pi">:</span> <span class="s">2</span>
  <span class="na">default</span><span class="pi">:</span>
    <span class="na">jobs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">build_docs</span>
</code></pre></div></div>

<p>See the comments above for what each step does.</p>

<h2 id="tell-circleci-to-build-pull-requests-for-your-repository">Tell CircleCI to build Pull Requests for your repository</h2>

<p>Because we’re doing this in order to preview changes to the documentation in a Pull Request,
we now need to tell CircleCI to run builds on PRs to your repo. To do so, go to the CircleCI UI, click on “Jobs”, then click
your project name, then click the settings button here:</p>

<p><img src="/images/2018/sphinx-circle-settings.png" alt="" /></p>

<p>In the next page, click on <strong>Advanced Settings</strong>, and finally switch on <strong>Build forked pull requests</strong>.</p>

<p>Now, Circle will build against the PRs of your repository.</p>

<h2 id="make-a-pull-request">Make a Pull Request</h2>

<p>Now it’s time to test things out. Make a Pull Request for your repository. GitHub should automatically
detect a CircleCI configuration, and run the job with the configuration you’ve specified.</p>

<p>Once the documentation is built (or if it fails) you can click on the CircleCI link from the GitHub UI
in order to see what happened.</p>

<p><img src="/images/2018/sphinx-circle-github-pr.png" alt="" /></p>

<h2 id="view-your-artifacts">View your artifacts</h2>

<p>You should be taken to a page that shows a summary of the recent CircleCI build for this PR.</p>

<p>If your documentation successfully built (and if you’ve told Sphinx to put the built site in <code class="highlighter-rouge">doc/_build/</code>) then
you can now click on the <strong>Artifacts</strong> tab. You should see a drop-down list of artifacts that CircleCI has
stored for you. Click on <strong>index.html</strong> and you should see a preview of your built documentation:</p>

<p><img src="/images/2018/sphinx-circle-artifacts.png" alt="" /></p>

<p>And that’s it! Obviously you can configure CircleCI in many more ways, but this is just a barebones example
to get you started. I hope you’ve found it useful!</p>

        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://predictablynoisy.com/tags/#documentation" class="page__taxonomy-item" rel="tag">documentation</a><span class="sep">, </span>
    
      
      
      <a href="https://predictablynoisy.com/tags/#sphinx" class="page__taxonomy-item" rel="tag">sphinx</a>
    
    </span>
  </p>




  






  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://predictablynoisy.com/categories/#documentation" class="page__taxonomy-item" rel="tag">documentation</a>
    
    </span>
  </p>


      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=https://predictablynoisy.com/circle-documentation-build" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://predictablynoisy.com/circle-documentation-build" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://predictablynoisy.com/circle-documentation-build" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://predictablynoisy.com/circle-documentation-build" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="https://predictablynoisy.com/summer-conferences-2018" class="pagination--pager" title="Summer conference report back
">Previous</a>
    
    
      <a href="https://predictablynoisy.com/rust-governance" class="pagination--pager" title="I like Rust’s governance structure
">Next</a>
    
  </nav>

    </div>

    
      

<div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>


    </script>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/choldgraf"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/choldgraf"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://predictablynoisy.com/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Chris Holdgraf. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="https://predictablynoisy.com/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'chrisholdgraf';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>

